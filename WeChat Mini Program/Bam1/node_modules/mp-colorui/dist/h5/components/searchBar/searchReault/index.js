import Nerv from "nervjs";
import Taro from "@tarojs/taro-h5";
import { View } from '@tarojs/components';
import ClFlex from "../../flex/index";
import ClText from "../../text/index";
import ClLayout from "../../layout/index";
import './index.scss';
import ClIcon from "../../icon/index";
import { generateId } from "../../utils/index";
export default class ClSearchResult extends Taro.Component {
  render() {
    const props = this.props;

    const [resultState, setResultState] = Taro.useState(props.result || []);
    Taro.useEffect(() => {
      const list = props.result || [];
      setResultState(list.map(item => {
        item.cu_search_bar_result_id = generateId();
        return item;
      }));
    }, [props.result]);
    const result = resultState || [];
    const showLoading = props.showLoading;
    const onTouchResult = props.onTouchResult;
    const resultComponent = result.map((item, index) => <View key={item.cu_search_bar_result_id} className="cl_search_result" onClick={() => {
      onTouchResult(index);
    }}>
      <ClLayout padding="xsmall" paddingDirection="vertical">
        <ClText text={item.title} size="large" />
        <ClText text={item.desc} size="xsmall" cut />
      </ClLayout>
    </View>);
    const loadingComponent = <ClLayout padding="normal" paddingDirection="vertical">
      <View className="cl_search_loading">
        <ClIcon iconName="loading2" />
      </View>
    </ClLayout>;
    return <View style={{ width: '100%' }}>
      <ClFlex direction="column" align="center" justify="center">
        {showLoading ? loadingComponent : resultComponent}
      </ClFlex>
    </View>;
  }

}
ClSearchResult.options = {
  addGlobalClass: true
};